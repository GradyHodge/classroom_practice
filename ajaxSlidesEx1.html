<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>AJAX EX 1</title>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"></link>

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

</head>
<body>
        <div id="getPosts" class="btn btn-info btn-lg">Get All Posts</div>
        <div id="postsId10" class="btn btn-success btn-lg">Get Posts with ID 10</div>
        <div id="commentsId12" class="btn btn-warning btn-lg">Get Comments with ID 12</div>
        <div id="postsId12" class="btn btn-danger btn-lg">Get All Posts from User with ID 2</div>
        <div id="updateMe1" class="btn btn-danger btn-lg">Update Post</div>
        <div id="updateMe2" class="btn btn-danger btn-lg">Update Title Only</div>
        <div id="deleteMe1" class="btn btn-danger btn-lg">Delete post</div>
        <div id="dukeNukem" class="btn btn-danger btn-lg">Duke Nukem</div>
        
        <section id="newDiv"></section>

        <script>
// 1) Get all posts
        document.getElementById("getPosts")
        .addEventListener("click", () => {
            $.get('http://jsonplaceholder.typicode.com/posts', 
                (data) => {
	            //console.log(data);
                    for (var i = 0; data.length > i; i++) {
                        data[i]
                        //console.log("iterating over data", data[i])

                        var domDiv = document.getElementById("newDiv");
                        var newDiv = document.createElement('div');
                        
                        newDiv.appendChild(document.createTextNode(data[i].title));
                        domDiv.appendChild(newDiv);
                    }
                })   
        });
        

// 2) Get post with id of 10
document.getElementById("postsID10")
.addEventListener("click", () => {
    $.get('http://jsonplaceholder.typicode.com/post/10', 
                (data) => {
	            //console.log(data);
                    var domDiv = document.getElementById("newDiv");
                    var newDiv = document.createElement('div');
                        
                    newDiv.appendChild(document.createTextNode(data[i].title));
                    domDiv.appendChild(newDiv);
                    });
                });

// 2) Get post with id of 10 (using Promises, cleaner and more modern, start with old way and then go to this new way)
$(document).on("click", "#postsId10", () => {
    $.ajax({
        url: 'http://jsonplaceholder.typicode.com/post/10',
        method: "GET",
    }).then((post) => {
        console.log(post);
        var dump99 = document.querySelector(".postsID10");
        var header1 = document.creatElement("h1");
        var post10_title = document.creatTextNode(post.title);
        varpost1_body = document.creatTextNode(post.body);
    });
});

// 2) Get post with id of 10 
document.getElementById("getPosts")
        .addEventListener("click", () => {
            $.get('http://jsonplaceholder.typicode.com/posts', 
                (data) => {
	            //console.log(data);
                //forEach loop
                $.
                posts.forEach(post => {
                    var dump99 = document.querySelector(".dump99");
                    var header1 = document.createElement("h4");
                    var post1 = document.creatTextNode(post.title);
                    dump99.appendChild(header1);
                    header1.appendChild(post1);
                    })
            })
        }) 


// 3) Get the comments from post with id of 12
$("#commentsId12").on("click", () => {
    $.ajax({
        url: 'http://jsonplaceholder.typicode.com/comments?postId=12',
        method: "GET",
    }).then(response => {
        console.log ()
    })
})
$.get('http://jsonplaceholder.typicode.com/post/12/comments', function(data){
	console.log(data);
});

// 4) Get all the posts from user with id of 2
$("#postData1").on("click", () => {
    $.ajax({
        url: "http://jsonplaceholder.typicode.com/posts",
        method:"POST",
        data: {userId:59, title:"Da Greatest", body: "Grady is"}
    }).then(response => {
        console.log(response.id);
        if(response.id === 101){
            console.log("hey, it posted")
        }
    })
})



// 5) Create a new post and log the id generated for it by the server
$.post('http://jsonplaceholder.typicode.com/posts',{
	userId: 1,
	title: "My New Post",
	body: "This is the body"
}, function(data){
	console.log(data.id)
})

$("#postData1").on("click", () => {
    $.ajax({
        url: "http://jsonplaceholder.typicode.com/posts/12",
        method:"PUT",
        data: {userId:59, title:"Da Greatest", body: "Grady is"}
    }).then(response => {
        console.log(response.id);
        }
    })
}

// // 6) Replace the post with id of 12
// $.ajax({
// 	method: 'PUT',
// 	url: 'http://jsonplaceholder.typicode.com/posts/12',
// 	data: {
// 		userId: 1,
// 		title: "New Post",
// 		body: "New post added"
// 	},
// 	complete: function(response){
// 		console.log(response.responseJSON);
// 	}
// })

$("#updateMe2").on("click", () => {
    $.ajax({
        url: "http://jsonplaceholder.typicode.com/posts/12",
        method:"PUT",
        data: {title:"Da Greatest", body: "Grady is"}
    }).then(response => {
        console.log(response);
        if(response)
        })
    })
// // 7) Update the title field of the post with id of 12
// $.ajax({
// 	method: 'PATCH',
// 	url: 'http://jsonplaceholder.typicode.com/posts/12',
// 	data: {
// title: "patched it"
// },
// 	complete: function(response){
// 		console.log(response.responseJSON);
// 	}
// })



// // 8) Delete the post with id of 12
// $.ajax({
// 	method: 'DELETE',
// 	url: 'http://jsonplaceholder.typicode.com/posts/12',
// 	complete: function(response){
// 		console.log(response.statusText);
// 	}
// })
$("#commentsId12").on("click", () => {
    $.ajax({
        url: 'http://jsonplaceholder.typicode.com/posts/12',
        method: "DELETE",
    }).then(response => {
        console.log ()
    })
}) 
        
//
$(document).on("click", "#dukeNukem", () => {
    $.ajax({
        url: "http://jsonplaceholder.typicode.com/posts",
        method: "GET",
    }).then(response => {
        for(var i = 0; i < response.length; i++){
        var infoLink = ("<button type="button" class="link" data-link = "http://jsonplaceholder.typicode.com/posts?postsId=' + response[i].id + '/comments>')
        var div = $("<div>");
        var header = $("<h2>").text(response[i].title);
        var p = $("<p>").text(response[i].body);
        $(div).append(header,p,infoLink);
        $(".dump99").append(div);
        }
    })
})
$(document).on("click", "link", function(){})
        </script>
    
</body>
</html>